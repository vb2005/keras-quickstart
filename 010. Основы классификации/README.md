# Работа №10
### Основы классификации

В данной работе рассматривается проблема построения классификатора и обработки изображений с его помощью. Предлагается исследовать набор данных MNIST, который представляет собой датасет из цифр от 0 до 9 на изображениях размером (28x28) точек. 
### Сведения о работе

Необходимые библиотеки: `keras, matplotlib`

Количество заданий для самостоятельного выполнения: ![](https://img.shields.io/badge/2%20задания-red)

Время на выполнение: ![](https://img.shields.io/badge/90-минут-blue)

### Введение
Обработка изображений - сложная задача, которая требует значительных ресу
Для задач машинного обучения важной составляющей является визуализация как исходных данных, так и метрик, полученных в процессе обучения модели. Графики позволяют наглядно оценить показатели, а также предоставить заказчику подробные и красивые отчёты по процессу подготовки моделей.

## Импорт библиотек и подготовка набора данных

В данной работе мы будем исследовать набор данных ```MNIST```.

В начале, подключите необходимые зависимости в проект:

``` python 
from keras.optimizers import *
from keras.models import Model, Sequential
from keras.layers import *
import tensorflow as tf
import matplotlib.pyplot as plt
import numpy as np
```

Теперь прочитаем набор данных при помощи встроенной функции:
``` python
(train_X, train_Y), (test_X, test_Y) = tf.keras.datasets.mnist.load_data()
```

Поскольку мы рассматриваем задачу классификации, мы должны перейти от номера класса к вектору вероятностей. Для этого будем использовать встроенную в Keras функцию. 

``` python
train_Y_en = tf.keras.utils.to_categorical(train_Y, num_classes=10)
test_Y_en  = tf.keras.utils.to_categorical(test_Y,  num_classes=10)
```

![](https://img.shields.io/badge/Задача%201-red)
``` python
# Задание 1. Изучите принцип работы функции to_categorical. Самостоятельно реализуйте функцию encode, которая будет выполнять подобное преобразование
```

![](https://img.shields.io/badge/Задача%202-red)
``` python
# Задание 2. Разработайте функцию, которая позволяет визуалзировать наборы данных. Выведите размерности исходных данных
```

## Разработка модели

Рассмотрим построение примитивной модели, которая позволит классифицировать данные изображения. В качестве входного тензора указывается размер изображения - (28, 28). В качестве выходного - 10 классов, а также функция нормировки - `softmax`. Для оценки потерь будет использоваться функцию `categorical_crossentropy`. Она обладает более стабильной сходимостью в задачах классификации


``` python
model = Sequential()
model.add(Flatten(input_shape=(28, 28)))
model.add(Dense(10, activation='relu'))
model.add(Dense(10, activation='softmax'))
model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])
```

## Запуск обучения
Запустите обучение сети. Оцените необходимое количество эпох для данной задачи.

``` python
history = model.fit(train_X, train_Y_en, batch_size=32, epochs=50, validation_data=(test_X, test_Y_en))
```

## Получение предсказания
Для того, чтобы получить предсказания для всего тестового набора, выполните следующий программный код:

``` python
Y_pred = model.predict(test_X)
```


## Самостоятельная работа
**Задача 0.** Внимательно изучите практический материал, выполнить все 2 мини-кейса.

**Задача 1.** Разработайте метод для визуализации результатов работы нейронной сети, на котором можно увидеть цифру, а также распреределение вероятностей по классам

**Задача 2.** Исследуйте поведение различных функций активации при построении моделей. Сделайте выводы о целесообразности их выбора

**Задача 3.** Визуализируйте результаты при помощи матрицы соответствия

## Контрольные вопросы
1. Что представляет из себя набор MNIST?
2. Какие особенности необходимо учитывать при построении классификаторов?
3. Как работает функция активации softmax?
4. В чем преимущество использования функции потерь categorical_crossentropy в сравнении с mse?
